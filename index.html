<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URSOTV PRO - Otimizado</title>
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
    <style>
        body { background: #050505; color: white; font-family: sans-serif; margin: 0; overflow: hidden; }
        #player-container { width: 100vw; height: 100vh; display: flex; align-items: center; justify-content: center; background: #000; }
        video { width: 100%; height: 100%; }
        .status-overlay { position: absolute; top: 10px; left: 10px; font-size: 12px; color: #ffcc00; z-index: 10; background: rgba(0,0,0,0.5); padding: 5px; border-radius: 4px; }
    </style>
</head>
<body>

<div id="status" class="status-overlay">Iniciando sistema...</div>
<div id="player-container">
    <video id="player" playsinline controls autoplay muted></video>
</div>

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>

<script>
    // LISTA DE PROXYS (Substituem a necessidade de VPN manual para erro CORS)
    const proxies = [
        "", // Tentativa direta
        "https://api.allorigins.win/raw?url=", 
        "https://corsproxy.io/?",
        "https://thingproxy.freeboard.io/fetch/"
    ];

    const streamUrl = "URL_DO_SEU_CANAL_AQUI.m3u8"; // Substitua pelo link real
    const statusEl = document.getElementById('status');
    const video = document.getElementById('player');
    let proxyIndex = 0;

    function initPlayer(source) {
        if (Hls.isSupported()) {
            const hls = new Hls({
                xhrSetup: function(xhr) { xhr.withCredentials = false; }
            });
            hls.loadSource(source);
            hls.attachMedia(video);
            hls.on(Hls.Events.MANIFEST_PARSED, () => {
                statusEl.innerText = "Conectado! Reproduzindo...";
                video.play().catch(() => {
                    statusEl.innerText = "Clique na tela para iniciar o áudio";
                });
            });

            // Erro de rede: Tenta o próximo "Proxy/VPN"
            hls.on(Hls.Events.ERROR, function (event, data) {
                if (data.fatal) {
                    console.warn("Erro de conexão, tentando túnel alternativo...");
                    tryNextProxy();
                }
            });
        } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
            video.src = source;
        }
    }

    function tryNextProxy() {
        if (proxyIndex < proxies.length) {
            const newUrl = proxies[proxyIndex] + encodeURIComponent(streamUrl);
            statusEl.innerText = `Tentando Servidor/VPN ${proxyIndex + 1}...`;
            proxyIndex++;
            initPlayer(newUrl);
        } else {
            statusEl.innerText = "Erro fatal: Todos os servidores falharam.";
        }
    }

    // Inicialização automática
    window.onload = () => {
        const player = new Plyr(video, { autoplay: true, muted: true });
        tryNextProxy();
    };
</script>
</body>
</html>
