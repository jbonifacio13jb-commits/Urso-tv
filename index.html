<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URSOTV PRO</title>
    <style>
        :root { --gold: #ffcc00; --bg: #050505; }
        body { background: var(--bg); color: white; font-family: sans-serif; margin: 0; text-align: center; }
        .header { padding: 15px; background: #111; border-bottom: 2px solid var(--gold); }
        .pata { font-size: 35px; filter: drop-shadow(0 0 8px var(--gold)); }
        
        .btn-group { display: flex; justify-content: center; gap: 8px; margin: 10px 0; flex-wrap: wrap; }
        button { background: #1a1a1a; color: var(--gold); border: 1px solid var(--gold); padding: 10px; border-radius: 5px; font-weight: bold; cursor: pointer; font-size: 10px; }
        button.active { background: var(--gold); color: black; box-shadow: 0 0 10px var(--gold); }

        .player-selector { display: none; margin-top: 20px; padding: 15px; background: #111; border-radius: 10px; border: 1px solid #333; width: 85%; max-width: 350px; margin-left: auto; margin-right: auto; }
        .player-btn { display: block; width: 100%; padding: 12px; margin: 8px 0; border-radius: 5px; font-weight: bold; text-decoration: none; font-size: 13px; color: white; border: none; cursor: pointer; }
        
        .mx { background: #0084ff; }
        .extreme { background: #ff004c; }

        .status-box { width: 85%; max-width: 350px; margin: 30px auto; background: #111; padding: 25px; border-radius: 15px; border: 1px solid #333; }
        .prog-bg { width: 100%; height: 10px; background: #222; border-radius: 5px; margin: 15px 0; overflow: hidden; }
        .prog-fill { width: 0%; height: 100%; background: var(--gold); box-shadow: 0 0 10px var(--gold); transition: width 0.2s; }
    </style>
</head>
<body>

<div class="header">
    <div class="pata">üêæ</div>
    <div style="font-size: 22px; font-weight: 900;">URSOTV <span style="color:var(--gold)">PRO</span></div>
    <div class="btn-group">
        <button onclick="scan(0, this)" id="b0">SERV 01</button>
        <button onclick="scan(1, this)" id="b1">SERV 02</button>
        <button onclick="scan(2, this)" id="b2">SERV 03</button>
    </div>
</div>

<div class="status-box" id="status-ui">
    <div id="msg" style="color: var(--gold); font-weight: bold; font-size: 16px;">AGUARDANDO...</div>
    <div class="prog-bg"><div id="bar" class="prog-fill"></div></div>
    <div id="detail" style="font-size: 11px; color: #555;">Selecione um servidor no topo</div>
</div>

<div id="player-ui" class="player-selector">
    <div style="font-size: 12px; margin-bottom: 15px; color: var(--gold); font-weight: bold;">SINAL ENCONTRADO!</div>
    <button onclick="openPlayer('mx')" class="player-btn mx">ABRIR NO MX PLAYER</button>
    <button onclick="openPlayer('extreme')" class="player-btn extreme">ABRIR NO IPTV EXTREME</button>
</div>

<script>
    const serverBases = [
        "http://dj.chefemcasa.store:8080/live/adl021222/iptvemcasa@1/",
        "http://provedorduo.xyz/live/09927119/49290268/",
        "http://rede.tvno.site/live/barreto1766/ma257799007/"
    ];

    let currentStreamUrl = "";

    function scan(idx, btn) {
        document.querySelectorAll('button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById('player-ui').style.display = 'none';
        document.getElementById('status-ui').style.display = 'block';
        
        let count = 0;
        const bar = document.getElementById('bar');
        const timer = setInterval(() => {
            count += 5;
            bar.style.width = count + "%";
            document.getElementById('msg').innerText = "SINTONIZANDO...";
            
            if(count >= 100) {
                clearInterval(timer);
                currentStreamUrl = serverBases[idx] + "1.m3u8";
                document.getElementById('status-ui').style.display = 'none';
                document.getElementById('player-ui').style.display = 'block';
            }
        }, 30);
    }

    function openPlayer(type) {
        const cleanUrl = currentStreamUrl.replace(/https?:\/\//, '');
        let intent = "";

        if(type === 'mx') {
            intent = `intent://${cleanUrl}#Intent;scheme=http;type=video/*;package=com.mxtech.videoplayer.ad;S.title=URSOTV%20PRO;end`;
        } else {
            // Nova estrutura de chamada para o IPTV Extreme Pro ou Free
            intent = `intent://${cleanUrl}#Intent;scheme=http;type=video/*;package=com.gomdev.iptvextreme;S.title=URSOTV%20PRO;end`;
        }

        window.location.href = intent;

        // Caso o intent falhe, tentamos abrir pelo protocolo direto ap√≥s 1 segundo
        setTimeout(() => {
            if(type === 'extreme') {
                window.location.href = "iptvextreme://" + currentStreamUrl;
            }
        }, 1000);
    }

    window.onload = () => document.getElementById('b0').click();
</script>
</body>
</html>
