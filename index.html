<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>URSOTV PREMIUM</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        :root { --primary: #00d4ff; --bg: #000000; }
        body { margin: 0; background: var(--bg); color: white; font-family: sans-serif; overflow: hidden; }
        #login-screen { position: fixed; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #000; z-index: 1000; text-align: center; }
        .logo-img { width: 180px; margin-bottom: 25px; border-radius: 20px; box-shadow: 0 0 25px var(--primary); border: 2px solid var(--primary); }
        .server-grid { display: flex; flex-direction: column; gap: 15px; width: 85%; max-width: 350px; }
        .btn-server { padding: 18px; border: 2px solid var(--primary); background: #111; color: var(--primary); border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 18px; transition: 0.3s; }
        
        /* EFEITO DE PISCAR */
        @keyframes pulsar { 0% { opacity: 1; box-shadow: 0 0 5px var(--primary); } 50% { opacity: 0.7; box-shadow: 0 0 25px var(--primary); } 100% { opacity: 1; box-shadow: 0 0 5px var(--primary); } }
        .conectando { animation: pulsar 0.6s infinite; background: var(--primary); color: #000; }

        #main-app { display: none; height: 100vh; flex-direction: row; }
        .side-bar { width: 180px; background: #080808; display: flex; flex-direction: column; padding: 15px; border-right: 1px solid #222; }
        .cat-item { padding: 12px; margin-bottom: 10px; background: #151515; border-radius: 8px; cursor: pointer; text-align: center; font-weight: bold; font-size: 14px; }
        .cat-item.active { background: var(--primary); color: #000; }
        .content-area { flex: 1; overflow-y: auto; padding: 15px; display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 15px; }
        .card { background: #121212; border-radius: 8px; overflow: hidden; cursor: pointer; text-align: center; border: 1px solid #222; }
        .card img { width: 100%; aspect-ratio: 2/3; object-fit: cover; }
        .card p { font-size: 11px; padding: 5px; margin: 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        #player-container { position: fixed; inset: 0; background: #000; display: none; z-index: 2000; }
        video { width: 100%; height: 100%; }
    </style>
</head>
<body>

    <div id="login-screen">
        <img src="logo.png" class="logo-img" onerror="this.src='https://via.placeholder.com/180/00d4ff/000000?text=URSO+TV'">
        <div class="server-grid">
            <button id="btn-play" class="btn-server" onclick="tentarConectar()">ACESSAR PLAYER 1</button>
        </div>
        <p id="status-msg" style="color: #00d4ff; margin-top: 20px; font-weight: bold;">Toque para iniciar</p>
    </div>

    <div id="main-app">
        <div class="side-bar">
            <div id="cat-canais" class="cat-item active" onclick="render('CANAIS')">CANAIS</div>
            <div id="cat-filmes" class="cat-item" onclick="render('FILMES')">FILMES</div>
            <button onclick="window.location.reload()" style="margin-top:auto; padding:10px; background:red; color:white; border:none; border-radius:5px; font-weight:bold;">SAIR</button>
        </div>
        <div id="content-grid" class="content-area"></div>
    </div>

    <div id="player-container">
        <button onclick="fecharPlayer()" style="position:absolute; top:15px; left:15px; z-index:2100; padding:10px 20px; background:var(--primary); color:#000; border:none; border-radius:5px; font-weight:bold;">❮ VOLTAR</button>
        <video id="video" controls></video>
    </div>

<script>
    let todos = { CANAIS: [], FILMES: [] };
    const linkM3U = "https://xcloudcine.xyz/get.php?username=619963334&password=327363322&type=m3u_plus";
    const hls = new Hls();
    const v = document.getElementById('video');

    async function tentarConectar() {
        const btn = document.getElementById('btn-play');
        const status = document.getElementById('status-msg');
        
        btn.classList.add('conectando');
        status.innerText = "Carregando lista de canais...";

        try {
            // Proxy para evitar erros de bloqueio do navegador/Android
            const r = await fetch("https://api.allorigins.win/raw?url=" + encodeURIComponent(linkM3U));
            if (!r.ok) throw new Error();
            const data = await r.text();
            
            organizar(data);
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('main-app').style.display = 'flex';
            render('CANAIS');
        } catch(e) {
            status.innerText = "Erro na conexão. Tente novamente.";
            btn.classList.remove('conectando');
        }
    }

    function organizar(data) {
        todos = { CANAIS: [], FILMES: [] };
        const lines = data.split('\n');
        for(let i=0; i < lines.length; i++) {
            if(lines[i].includes('#EXTINF:')) {
                const name = lines[i].split(',')[1] || "Canal";
                const logo = lines[i].match(/tvg-logo="([^"]+)"/)?.[1] || 'logo.png';
                const url = lines[i+1]?.trim();
                
                if(url) {
                    const item = { name, logo, url };
                    if(url.includes('.mp4') || url.includes('.mkv')) todos.FILMES.push(item);
                    else todos.CANAIS.push(item);
                }
            }
        }
    }

    function render(cat) {
        document.querySelectorAll('.cat-item').forEach(c => c.classList.remove('active'));
        document.getElementById(`cat-${cat.toLowerCase()}`).classList.add('active');
        const grid = document.getElementById('content-grid');
        grid.innerHTML = todos[cat].map(i => `
            <div class="card" onclick="play('${i.url}')">
                <img src="${i.logo}" onerror="this.src='https://via.placeholder.com/120/111/00d4ff?text=URSO'">
                <p>${i.name}</p>
            </div>
        `).join('');
    }

    function play(u) {
        document.getElementById('player-container').style.display='block';
        if(Hls.isSupported()) { hls.loadSource(u); hls.attachMedia(v); v.play(); }
        else { v.src = u; v.play(); }
    }

    function fecharPlayer() { document.getElementById('player-container').style.display='none'; v.pause(); }
</script>
</body>
</html>
